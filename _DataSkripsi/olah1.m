clc;
clear;

%Variables
% N = Neutral : White
% L = Left 	  : Red
% R = Right	  : Blue
fs = 200;	% sesuai ganglion pakai 200Hz

% ambil data dan buang N pertama (pemanasan)
load('D:\Jaler\OpenBCI_GUI\_DataSkripsi\R11.txt');
data_raw = R11;


% step 2. Notch 50Hz
[b,a] = butter(2,[49 51]/(fs/2), 'stop');
% bandpass Filter
[d,c] = butter(2,[0.5 50]/(fs/2), 'bandpass');
for i=1:4
	data_raw(:,i)=filter(b,a,data_raw(:,i));
	data_raw(:,i)=filter(d,c,data_raw(:,i));
end


for i=1:4
	N{i} = [{data_raw(1616:2222,i)};{data_raw(3238:4053,i)};{data_raw(5065:5673,i)};...
        {data_raw(6691:7492,i)};{data_raw(8504:9106,i)}];
	L{i} = [{data_raw(607:1615,i)};{data_raw(4054:5064,i)};{data_raw(7493:8503,i)}];
	R{i} = [{data_raw(2223:3237,i)};{data_raw(5674:6690,i)};{data_raw(9107:10123,i)}];
end

% ambil data 2 detik (0-2 detik)
% N{i} : |1616-2222| = 606 (1 detik = 202)
% 		 |3238-4053| = 815 (1 detik = 203)
% 		 |5065-5673| = 608 (1 detik = 202)
% 		 |6691-7492| = 801 (1 detik = 200)
% 		 |8054-9106| = 602 (1 detik = 200)
% N1_1 = N{1,1}{1,1}(1:404,1);
% N1_2 = N{1,1}{1,1}(203:606,1);
% N1_3 = N{1,1}{2,1}(1:406,1);
% N1_4 = N{1,1}{2,1}(204:609,1);
% N1_5 = N{1,1}{2,1}(407:812,1);
% N1_6 = N{1,1}{3,1}(1:402,1);
% N1_7 = N{1,1}{3,1}(202:603,1);
% N1_8 = N{1,1}{4,1}(1:400,1);
% N1_9 = N{1,1}{4,1}(201:600,1);
% N1_10 = N{1,1}{4,1}(401:800,1);
% N1_11 = N{1,1}{5,1}(1:400,1);
% N1_12 = N{1,1}{5,1}(201:600,1);

% 2 detik : 2x200 = 400 (dalam satuan indeks)
% N1_1 = N{1,1}{1,1}(1:400,1);
% N1_2 = N{1,1}{1,1}(201:600,1);
% N1_3 = N{1,1}{2,1}(1:400,1);
% N1_4 = N{1,1}{2,1}(201:600,1);
% N1_5 = N{1,1}{2,1}(401:800,1);
% N1_6 = N{1,1}{3,1}(1:400,1);
% N1_7 = N{1,1}{3,1}(201:600,1);
% N1_8 = N{1,1}{4,1}(1:400,1);
% N1_9 = N{1,1}{4,1}(201:600,1);
% N1_10 = N{1,1}{4,1}(401:800,1);
% N1_11 = N{1,1}{5,1}(1:400,1);
% N1_12 = N{1,1}{5,1}(201:600,1);

% for i=1:4
%     N1 = N{i,1}{1,1}(1:400,1);
%     N2 = N{i,1}{1,1}(201:600,1);
%     N3 = N{i,1}{2,1}(1:400,1);
%     N4 = N{i,1}{2,1}(201:600,1);
%     N5 = N{i,1}{2,1}(401:800,1);
%     N6 = N{i,1}{3,1}(1:400,1);
%     N7 = N{i,1}{3,1}(201:600,1);
%     N8 = N{i,1}{4,1}(1:400,1);
%     N9 = N{i,1}{4,1}(201:600,1);
%     N10 = N{i,1}{4,1}(401:800,1);
%     N11 = N{i,1}{5,1}(1:400,1);
%     N12 = N{i,1}{5,1}(201:600,1);
% end

for i=1:4
	n{1,i} = N{1,i}{1,1}(1:400,1);
    n{2,i} = N{1,i}{1,1}(201:600,1);
    n{3,i} = N{1,i}{2,1}(1:400,1);
    n{4,i} = N{1,i}{2,1}(201:600,1);
    n{5,i} = N{1,i}{2,1}(401:800,1);
    n{6,i} = N{1,i}{3,1}(1:400,1);
    n{7,i} = N{1,i}{3,1}(201:600,1);
    n{8,i} = N{1,i}{4,1}(1:400,1);
    n{9,i} = N{1,i}{4,1}(201:600,1);
    n{10,i} = N{1,i}{4,1}(401:800,1);
    n{11,i} = N{1,i}{5,1}(1:400,1);
    n{12,i} = N{1,i}{5,1}(201:600,1);

    l{1,i} = L{1,i}{1,1}(1:400,1);
    l{2,i} = L{1,i}{1,1}(201:600,1);
    l{3,i} = L{1,i}{1,1}(401:800,1);
    l{4,i} = L{1,i}{1,1}(601:1000,1);
    l{5,i} = L{1,i}{2,1}(1:400,1);
    l{6,i} = L{1,i}{2,1}(201:600,1);
    l{7,i} = L{1,i}{2,1}(401:800,1);
    l{8,i} = L{1,i}{2,1}(601:1000,1);
    l{9,i} = L{1,i}{3,1}(1:400,1);
    l{10,i} = L{1,i}{3,1}(201:600,1);
    l{11,i} = L{1,i}{3,1}(401:800,1);
    l{12,i} = L{1,i}{3,1}(601:1000,1);

    r{1,i} = R{1,i}{1,1}(1:400,1);
    r{2,i} = R{1,i}{1,1}(201:600,1);
    r{3,i} = R{1,i}{1,1}(401:800,1);
    r{4,i} = R{1,i}{1,1}(601:1000,1);
    r{5,i} = R{1,i}{2,1}(1:400,1);
    r{6,i} = R{1,i}{2,1}(201:600,1);
    r{7,i} = R{1,i}{2,1}(401:800,1);
    r{8,i} = R{1,i}{2,1}(601:1000,1);
    r{9,i} = R{1,i}{3,1}(1:400,1);
    r{10,i} = R{1,i}{3,1}(201:600,1);
    r{11,i} = R{1,i}{3,1}(401:800,1);
    r{12,i} = R{1,i}{3,1}(601:1000,1);
end

for i=1:4
	n_cat{i} = cat(2,n{:,i});
	n_mean{i} = mean(n_cat{i},2);
    
    l_cat{i} = cat(2,l{:,i});
    l_mean{i} = mean(l_cat{i},2);
    
    r_cat{i} = cat(2,r{:,i});
    r_mean{i} = mean(r_cat{i},2);
end

	figure(1);
	hold on
	plot(n_mean{1},'r');
	plot(n_mean{2},'g');
	plot(n_mean{3},'b');
	plot(n_mean{4},'m');
	hold off
    legend('CH1','CH2','CH3','CH4')

	figure(2);
	hold on
	plot(l_mean{1},'r');
	plot(l_mean{2},'g');
	plot(l_mean{3},'b');
	plot(l_mean{4},'m');
	hold off
    legend('CH1','CH2','CH3','CH4')
    
	figure(3);
	hold on
	plot(r_mean{1},'r');
	plot(r_mean{2},'g');
	plot(r_mean{3},'b');
	plot(r_mean{4},'m');
	hold off
    legend('CH1','CH2','CH3','CH4')
% Data di rata-rata


% for i=1:length(N{1,1})
% 	N1_
% end


% for i=1:length(N)

% 	end